<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://cainefm.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://cainefm.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-08-23T07:38:37+00:00</updated><id>https://cainefm.github.io/feed.xml</id><title type="html">blank</title><subtitle>Personal webpage for Fan Min. </subtitle><entry><title type="html">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</title><link href="https://cainefm.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra/" rel="alternate" type="text/html" title="Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra"/><published>2024-05-14T00:00:00+00:00</published><updated>2024-05-14T00:00:00+00:00</updated><id>https://cainefm.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra</id><content type="html" xml:base="https://cainefm.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra/"><![CDATA[]]></content><author><name></name></author><summary type="html"><![CDATA[We’re sharing updates across our Gemini family of models and a glimpse of Project Astra, our vision for the future of AI assistants.]]></summary></entry><entry><title type="html">Displaying External Posts on Your al-folio Blog</title><link href="https://cainefm.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/" rel="alternate" type="text/html" title="Displaying External Posts on Your al-folio Blog"/><published>2022-04-23T23:20:09+00:00</published><updated>2022-04-23T23:20:09+00:00</updated><id>https://cainefm.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog</id><content type="html" xml:base="https://cainefm.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/"><![CDATA[]]></content><author><name></name></author></entry><entry><title type="html">The first blog in Github</title><link href="https://cainefm.github.io/blog/2020/start-to-note/" rel="alternate" type="text/html" title="The first blog in Github"/><published>2020-12-23T15:12:00+00:00</published><updated>2020-12-23T15:12:00+00:00</updated><id>https://cainefm.github.io/blog/2020/start-to-note</id><content type="html" xml:base="https://cainefm.github.io/blog/2020/start-to-note/"><![CDATA[<ul> <li><a href="#bg">Background / 背景</a></li> <li><a href="#bb">Build a blog in Github</a></li> <li><a href="#R">Jekyll with Rmarkdown / 将Rmarkdown上传至Blog</a></li> </ul> <p id="bg"></p> <h2 id="background">Background</h2> <p>I am a student, and now working on the phramocoepidimiology studies in the HKU.</p> <p>Since my team is focusing on the statistical studies with big datasets, in our team, the members are using R or SAS. Now, I spent most of the time on R or python. In the near future, I may use SAS as well.</p> <p>In the previous coding life, it is inevitable to have many difficulties, ig. setting up coding enviornment, different codings for analysis, or different statistically models. This blog aims at recording some interesting points about researches or codings.</p> <p id="bb"></p> <h2 id="how-to-build-such-a-blog">How to build such a blog</h2> <p>The blog is build on <a href="https://pages.github.com/">GitHub</a> and <a href="http://jekyllrb.com/">Jekyll</a>. The Theme is provided by <a href="Huxpro/huxpro.github.io">Hux</a>.</p> <p>It is easy to use and build. The process is list:</p> <ol> <li>Learn and install <strong>Git</strong>.</li> <li>Register in <strong>Github</strong>.</li> <li>Instal <strong>jekyll</strong></li> <li>Fork the template in Github. You can check varies <a href="https://jekyllrb.com/docs/themes/">jekyll template </a> online.</li> <li>Test locally by : bundle exec jekyll serve</li> </ol> <p id="R"></p> <h2 id="rmarkdown-with-jekyll">Rmarkdown with jekyll</h2> <p>The coding in R is quite simple and stratforwards. However, it is desgined for just statistical analysis. So, sometimes it will be better to learn something else to support with it, eg. python, SQL, or JAVA.</p> <p>In the routine study, Rmarkdown is frequently used rather than markdown. However, it is not so easy to knit the Rmarkdown into the jekyll. The only way I found now is generate <code class="language-plaintext highlighter-rouge">md</code> files from <code class="language-plaintext highlighter-rouge">Rmarkdown</code> first.</p> <p>1.The header in Rmarkdown for transfering into md is</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
title: "This is a test rmarkdown file for Github blog"
author: "FM"
date: '`r Sys.Date()`'
output:
  md_document:
    variant: markdown_github
---
</code></pre></div></div> <ol> <li> <p>copy the md files into the _post and relocate those pic files</p> </li> <li> <p>change the header in the md file</p> </li> </ol> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
title: "This is a test rmarkdown file for Github blog"
author: "FM"
header-style: text
categories: rblogging
layout: post
tags:
 - testing
 - ggplot2
---

</code></pre></div></div> <h3 id="example-knited-by-rmarkdown">Example knited by rmarkdown</h3> <h4 id="r-basic-codes">R basic codes</h4> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">4</span><span class="o">:</span><span class="m">6</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/img/in-post/rmarkdown-testing/unnamed-chunk-1-1.png" alt=""/></p> <h4 id="plots-by-ggplots">plots by ggplots</h4> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w"> </span><span class="c1"># load the packages</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">displ</span><span class="p">,</span><span class="w"> </span><span class="n">hwy</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">class</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"loess"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="w">
    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Fuel efficiency generally decreases with engine size"</span><span class="p">,</span><span class="w">
    </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Two seaters (sports cars) are an exception because of their light weight"</span><span class="p">,</span><span class="w">
    </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Data from fueleconomy.gov"</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/img/in-post/rmarkdown-testing/unnamed-chunk-1-1.png" alt=""/></p> <p><img src="https://shiring.github.io/blogging/2016/12/04/diy_your_own_blog" alt="Old method by md"/></p>]]></content><author><name>FAN Min</name></author><category term="Life"/><category term="Rmarkdown"/><category term="Enviornment"/><summary type="html"><![CDATA[Background / 背景 Build a blog in Github Jekyll with Rmarkdown / 将Rmarkdown上传至Blog]]></summary></entry><entry><title type="html">Two regression based methods for interrupted time series</title><link href="https://cainefm.github.io/blog/2020/ITS-study-test-two-model/" rel="alternate" type="text/html" title="Two regression based methods for interrupted time series"/><published>2020-12-23T00:00:00+00:00</published><updated>2020-12-23T00:00:00+00:00</updated><id>https://cainefm.github.io/blog/2020/ITS-study-test-two-model</id><content type="html" xml:base="https://cainefm.github.io/blog/2020/ITS-study-test-two-model/"><![CDATA[<h2 id="1-background">1. Background</h2> <p>The textbook for ITS is the JLB’s tutorial <a href="https://pubmed.ncbi.nlm.nih.gov/27283160-interrupted-time-series-regression-for-the-evaluation-of-public-health-interventions-a-tutorial/">《Interrupted time series regression for the evaluation of public health interventions: a tutorial》</a>. When i dig deeper, i found the ultimate reference was AKD articles in 2002 <a href="https://pubmed.ncbi.nlm.nih.gov/12174032-segmented-regression-analysis-of-interrupted-time-series-studies-in-medication-use-research/">《Segmented regression analysis of interrupted time series studies in medication use research》</a>. But the formulas used in these two papers have a slight difference.</p> <h2 id="2-the-jlbs-interaction-model">2. The JLB’s <strong>interaction model</strong>:</h2> \[Y\sim{\sf}\beta_{1}·Time+\beta_{2}·Intervention+\beta_{3}·Time·Intervention\] <h3 id="21-the-dataset-lookd-like">2.1 The dataset lookd like:</h3> <hr/> <p><img src="/img/in-post/its/Capture1.PNG" alt=""/></p> <h3 id="22-interpretation-of-parameters">2.2 Interpretation of parameters</h3> <hr/> <p><img src="/img/in-post/its/Capture3.PNG" alt=""/></p> <h2 id="3-the-akds-additional-model">3. The AKD’s <strong>additional model</strong>:</h2> <hr/> \[Y \sim {\sf } \beta_{1}·Time + \beta_{2}·Intervention +\beta_{3}·NewTimeAfter Intervention\] <h3 id="31-the-dataset-looks-like">3.1 The dataset looks like:</h3> <hr/> <p><img src="/img/in-post/its/Capture2.PNG" alt=""/></p> <h3 id="32-interpretation-of-parameters">3.2 Interpretation of parameters</h3> <hr/> <p><img src="/img/in-post/its/Capture4.PNG" alt=""/></p> <h2 id="4-the-difference-between-two-models">4 The difference between two models</h2> <h3 id="41-generate-a-dataset">4.1 Generate a dataset</h3> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s1">'ggplot2'</span><span class="p">)</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">999</span><span class="p">)</span><span class="w">
</span><span class="n">testdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">outcome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ceiling</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">100</span><span class="p">)),</span><span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">PCV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">70</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">30</span><span class="p">)),</span><span class="n">NewTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">70</span><span class="p">),</span><span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">))</span><span class="w">
</span><span class="n">testdf</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##     outcome Time PCV NewTime
## 1        40    1   0       0
## 2        59    2   0       0
## 3        11    3   0       0
## 4        86    4   0       0
## 5        79    5   0       0
## 6        13    6   0       0
## 7        62    7   0       0
## 8        10    8   0       0

## 95       52   95   1      25
## 96       18   96   1      26
## 97       73   97   1      27
## 98       51   98   1      28
## 99       50   99   1      29
## 100      90  100   1      30
</code></pre></div></div> <h3 id="42-model-with-interaction-term">4.2 Model with interaction term</h3> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">testdf</span><span class="p">,</span><span class="n">outcome</span><span class="o">~</span><span class="n">Time</span><span class="o">+</span><span class="n">PCV</span><span class="o">+</span><span class="n">Time</span><span class="o">*</span><span class="n">PCV</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">test1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        Time         PCV    Time:PCV
##  44.3055901   0.2264019 -69.8521232   0.5827194
</code></pre></div></div> <h3 id="43-model-with-additional-term">4.3 Model with additional term</h3> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">testdf</span><span class="p">,</span><span class="n">outcome</span><span class="o">~</span><span class="n">Time</span><span class="o">+</span><span class="n">PCV</span><span class="o">+</span><span class="n">NewTime</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">test2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        Time         PCV     NewTime
##  44.3055901   0.2264019 -29.0617683   0.5827194
</code></pre></div></div> <p><strong>Two of the paper both pointed out that the parameter of PCV is the slope changes after intervention. But the numbers are quite different.</strong></p> <p><strong>I think one of them is wrong, or we should present it after some adjustments like Dr.Qiu did in the Wechat group. It may be the reason why we always see a level change even we just used the slope-only model in JLB’s method.</strong></p> <p><strong>I am not going to say JLB’s method is wrong. I consider that it is not appropriate for the slope-only model, and we should be cautious when interpreting the level’s parameter.</strong></p> <p><strong>I am still thinking from the formula perspective. Maybe my point of view is wrong. Pls save me.</strong></p> <h2 id="5slope-only-model-in-two-method">5.Slope-only model in two method</h2> <hr/> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">testdf</span><span class="p">,</span><span class="n">outcome</span><span class="o">~</span><span class="n">Time</span><span class="o">+</span><span class="n">Time</span><span class="o">:</span><span class="n">PCV</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">test3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        Time    Time:PCV
##  43.0861172   0.2523481  -0.2378050
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">testdf</span><span class="p">,</span><span class="n">outcome</span><span class="o">~</span><span class="n">Time</span><span class="o">+</span><span class="n">NewTime</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">test4</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        Time     NewTime
##  48.5384253   0.0475497  -0.2601473
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predicted_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">outcome_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">test3</span><span class="p">,</span><span class="n">testdf</span><span class="p">),</span><span class="n">Time</span><span class="o">=</span><span class="n">testdf</span><span class="o">$</span><span class="n">Time</span><span class="p">)</span><span class="w">
</span><span class="n">predicted_df2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">outcome_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">test4</span><span class="p">,</span><span class="n">testdf</span><span class="p">),</span><span class="n">Time</span><span class="o">=</span><span class="n">testdf</span><span class="o">$</span><span class="n">Time</span><span class="p">,</span><span class="n">NewTime</span><span class="o">=</span><span class="n">testdf</span><span class="o">$</span><span class="n">NewTime</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">testdf</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">outcome</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicted_df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">outcome_pred</span><span class="p">))</span><span class="o">+</span><span class="w">
    </span><span class="n">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicted_df2</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Time</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">outcome_pred</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <p><img src="/img/in-post/its/unnamed-chunk-4-1.png" alt=""/></p> <h3 id="51-fixed-the-previous-problem-by-changing-the-time">5.1. Fixed the previous problem by changing the time</h3> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">testdf</span><span class="p">,</span><span class="n">outcome</span><span class="o">~</span><span class="n">Time</span><span class="o">+</span><span class="n">NewTime</span><span class="o">:</span><span class="n">PCV</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">test5</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        Time NewTime:PCV
##  48.5384253   0.0475497  -0.2601473
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predicted_df3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">outcome_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">test5</span><span class="p">,</span><span class="n">testdf</span><span class="p">),</span><span class="n">Time</span><span class="o">=</span><span class="n">testdf</span><span class="o">$</span><span class="n">Time</span><span class="p">,</span><span class="n">NewTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">testdf</span><span class="o">$</span><span class="n">NewTime</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">testdf</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">outcome</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicted_df3</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">outcome_pred</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <p><img src="/img/in-post/its/unnamed-chunk-5-1.png" alt=""/></p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">testdf</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">outcome</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicted_df2</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Time</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">outcome_pred</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <p><img src="/img/in-post/its/unnamed-chunk-5-2.png" alt=""/></p> <h2 id="6-apply-to-our-dataset">6. Apply to our dataset</h2> <hr/> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s1">'stdpm.csv'</span><span class="p">)</span><span class="w">
</span><span class="n">df</span><span class="o">$</span><span class="n">NewTime</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">69</span><span class="p">),</span><span class="m">1</span><span class="o">:</span><span class="p">(</span><span class="m">166-69</span><span class="p">))</span><span class="w">
</span><span class="n">df</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##       X year month pneu_ad  stdpop time pcv pcv.lag1 pcv.lag3 pcv.lag6 pcv.lag9
## 1     1 2004     1    1562 5514526    1   0        0        0        0        0
## 2     2 2004     2    2272 5564488    2   0        0        0        0        0
## 3     3 2004     3    2343 5609644    3   0        0        0        0        0
## 4     4 2004     4    2569 5568791    4   0        0        0        0        0
## 5     5 2004     5    2500 5585966    5   0        0        0        0        0
## 6     6 2004     6    2626 5559820    6   0        0        0        0        0

## 163 163 2017     7    4840 9013479  163   1        1        1        1        1
## 164 164 2017     8    3913 9070214  164   1        1        1        1        1
## 165 165 2017     9    3602 8957569  165   1        1        1        1        1
## 166 166 2017    10    3650 9032499  166   1        1        1        1        1
##         rate      lag NewTime
## 1   2.832519       NA       0
## 2   4.083035 7.353722       0
## 3   4.176736 7.728416       0
## 4   4.613210 7.759187       0
## 5   4.475501 7.851272       0
## 6   4.723174 7.824046       0

## 163 5.369736 8.396155      94
## 164 4.314121 8.484670      95
## 165 4.021180 8.272060      96
## 166 4.040964 8.189245      97
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Interaction.model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">pneu_ad</span><span class="o">~</span><span class="n">time</span><span class="o">+</span><span class="n">time</span><span class="o">:</span><span class="n">pcv</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">Interaction.model</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        time    time:pcv
## 2836.755182    2.976605    6.849634
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Interaction.model.adj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">pneu_ad</span><span class="o">~</span><span class="n">time</span><span class="o">+</span><span class="n">NewTime</span><span class="o">:</span><span class="n">pcv</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">Interaction.model.adj</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        time NewTime:pcv
## 2437.493871   15.776112   -6.887371
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Additional.model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">pneu_ad</span><span class="o">~</span><span class="n">time</span><span class="o">+</span><span class="n">NewTime</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">Additional.model</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        time     NewTime
## 2437.493871   15.776112   -6.887371
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predicted_df.in</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">outcome_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">Interaction.model</span><span class="p">,</span><span class="n">df</span><span class="p">),</span><span class="n">Time</span><span class="o">=</span><span class="n">df</span><span class="o">$</span><span class="n">time</span><span class="p">)</span><span class="w">

</span><span class="n">predicted_df.in.adj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">outcome_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">Interaction.model.adj</span><span class="p">,</span><span class="n">df</span><span class="p">),</span><span class="n">Time</span><span class="o">=</span><span class="n">df</span><span class="o">$</span><span class="n">time</span><span class="p">)</span><span class="w">

</span><span class="n">predicted_df.ad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">outcome_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">Additional.model</span><span class="p">,</span><span class="n">df</span><span class="p">),</span><span class="n">Time</span><span class="o">=</span><span class="n">df</span><span class="o">$</span><span class="n">time</span><span class="p">,</span><span class="n">NewTime</span><span class="o">=</span><span class="n">df</span><span class="o">$</span><span class="n">NewTime</span><span class="p">)</span><span class="w">


</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pneu_ad</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicted_df.in</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">outcome_pred</span><span class="p">))</span><span class="o">+</span><span class="w">
    </span><span class="n">ggtitle</span><span class="p">(</span><span class="s1">'JBL model'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/img/in-post/its/unnamed-chunk-8-1.png" alt=""/></p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pneu_ad</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'orange'</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicted_df.in.adj</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">outcome_pred</span><span class="p">))</span><span class="o">+</span><span class="w">
    </span><span class="n">ggtitle</span><span class="p">(</span><span class="s1">'JBL adjusted model'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/img/in-post/its/unnamed-chunk-8-2.png" alt=""/></p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pneu_ad</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicted_df.ad</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Time</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">outcome_pred</span><span class="p">))</span><span class="o">+</span><span class="w">
    </span><span class="n">ggtitle</span><span class="p">(</span><span class="s1">'AKD model'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/img/in-post/its/unnamed-chunk-8-3.png" alt=""/></p> <h2 id="limitation">Limitation</h2> <h2 id="the-possion-regression-should-be-used-in-the-model-rather-than-count-data-and-i-did-not-add-offset-and-deseasonalized-terms-in-the-model">The possion regression should be used in the model rather than count data. And I did not add offset and deseasonalized terms in the model.</h2> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### 4.3 Model with additional term</span><span class="w">
</span><span class="n">testtesttest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">testdf</span><span class="p">[</span><span class="n">testdf</span><span class="o">$</span><span class="n">PCV</span><span class="o">==</span><span class="m">0</span><span class="p">,],</span><span class="n">outcome</span><span class="o">~</span><span class="n">Time</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">testtesttest</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        Time
##  44.3055901   0.2264019
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">testtesttest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">testdf</span><span class="p">[</span><span class="n">testdf</span><span class="o">$</span><span class="n">PCV</span><span class="o">==</span><span class="m">1</span><span class="p">,],</span><span class="n">outcome</span><span class="o">~</span><span class="n">Time</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">testtesttest</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (Intercept)        Time
## -25.5465332   0.8091212
</code></pre></div></div>]]></content><author><name>FAN Min</name></author><category term="epi"/><summary type="html"><![CDATA[1. Background]]></summary></entry></feed>